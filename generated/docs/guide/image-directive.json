{
  "id": "guide/image-directive",
  "title": "Getting started with NgOptimizedImage",
  "contents": "\n\n\n\n\n<div class=\"content\">\n  <h1 id=\"getting-started-with-ngoptimizedimage\">Getting started with NgOptimizedImage<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#getting-started-with-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h1>\n<p>The <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> directive makes it easy to adopt performance best practices for loading images.</p>\n<p>The directive ensures that the loading of the <a href=\"http://web.dev/lcp\">Largest Contentful Paint (LCP)</a> image is prioritized by:</p>\n<ul>\n<li>Automatically setting the <code>fetchpriority</code> attribute on the <code>&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a>></code> tag</li>\n<li>Lazy loading other images by default</li>\n<li>Automatically generating a preconnect link tag in the document head</li>\n<li>Automatically generating a <code>srcset</code> attribute</li>\n<li>Generating a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload\">preload hint</a> if app is using SSR</li>\n</ul>\n<p>In addition to optimizing the loading of the LCP image, <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> enforces a number of image best practices, such as:</p>\n<ul>\n<li>Using <a href=\"https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options\">image CDN URLs to apply image optimizations</a></li>\n<li>Preventing layout shift by requiring <code>width</code> and <code>height</code></li>\n<li>Warning if <code>width</code> or <code>height</code> have been set incorrectly</li>\n<li>Warning if the image will be visually distorted when rendered</li>\n</ul>\n<p><strong>Note: Although the <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> directive was made a stable feature in Angular version 15, it has been backported and is available as a stable feature in versions 13.4.0 and 14.3.0 as well. </strong></p>\n<h2 id=\"getting-started\">Getting Started<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#getting-started\"><i class=\"material-icons\">link</i></a></h2>\n<h4 id=\"step-1-import-ngoptimizedimage\">Step 1: Import NgOptimizedImage<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-1-import-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h4>\n<code-example format=\"typescript\" language=\"typescript\">\n\nimport { <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a> } from '@angular/common'\n\n</code-example>\n<p>The directive is defined as a <a href=\"/guide/standalone-components\">standalone directive</a>, so components should import it directly.</p>\n<h4 id=\"step-2-optional-set-up-a-loader\">Step 2: (Optional) Set up a Loader<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-2-optional-set-up-a-loader\"><i class=\"material-icons\">link</i></a></h4>\n<p>An image loader is not <strong>required</strong> in order to use NgOptimizedImage, but using one with an image CDN enables powerful performance features, including automatic <code>srcset</code>s for your images.</p>\n<p>A brief guide for setting up a loader can be found in the <a href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\">Configuring an Image Loader</a> section at the end of this page.</p>\n<h4 id=\"step-3-enable-the-directive\">Step 3: Enable the directive<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-3-enable-the-directive\"><i class=\"material-icons\">link</i></a></h4>\n<p>To activate the <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> directive, replace your image's <code>src</code> attribute with <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code>.</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\">\n\n</code-example>\n<p>If you're using a <a href=\"guide/image-directive#built-in-loaders\">built-in third-party loader</a>, make sure to omit the base URL path from <code>src</code>, as that will be prepended automatically by the loader.</p>\n<h4 id=\"step-4-mark-images-as-priority\">Step 4: Mark images as <code>priority</code><a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-4-mark-images-as-priority\"><i class=\"material-icons\">link</i></a></h4>\n<p>Always mark the <a href=\"https://web.dev/lcp/#what-elements-are-considered\">LCP image</a> on your page as <code>priority</code> to prioritize its loading.</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" priority>\n\n</code-example>\n<p>Marking an image as <code>priority</code> applies the following optimizations:</p>\n<ul>\n<li>Sets <code>fetchpriority=high</code> (read more about priority hints <a href=\"https://web.dev/priority-hints\">here</a>)</li>\n<li>Sets <code>loading=eager</code> (read more about native lazy loading <a href=\"https://web.dev/browser-level-image-lazy-loading\">here</a>)</li>\n<li>Automatically generates a <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload\">preload link element</a> if <a href=\"/guide/ssr\">rendering on the server</a>.</li>\n</ul>\n<p>Angular logs an error during development if the LCP element is an image that does not have the <code>priority</code> attribute, as this can hurt loading performance significantly. A pageâ€™s LCP element can vary based on a number of factors - such as the dimensions of a user's screen, so a page may have multiple images that should be marked <code>priority</code>. See <a href=\"https://web.dev/css-web-vitals/#images-and-largest-contentful-paint-lcp\">CSS for Web Vitals</a> for more details.</p>\n<h4 id=\"step-5-include-height-and-width\">Step 5: Include Height and Width<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#step-5-include-height-and-width\"><i class=\"material-icons\">link</i></a></h4>\n<p>In order to prevent <a href=\"https://web.dev/css-web-vitals/#images-and-layout-shifts\">image-related layout shifts</a>, NgOptimizedImage requires that you specify a height and width for your image, as follows:</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\">\n\n</code-example>\n<p>For <strong>responsive images</strong> (images which you've styled to grow and shrink relative to the viewport), the <code>width</code> and <code>height</code> attributes should be the intrinsic size of the image file. For responsive images it's also important to <a href=\"guide/image-directive#responsive-images\">set a value for <code>sizes</code>.</a></p>\n<p>For <strong>fixed size images</strong>, the <code>width</code> and <code>height</code> attributes should reflect the desired rendered size of the image. The aspect ratio of these attributes should always match the intrinsic aspect ratio of the image.</p>\n<p>Note: If you don't know the size of your images, consider using \"fill mode\" to inherit the size of the parent container, as described below:</p>\n<h3 id=\"using-fill-mode\">Using <code>fill</code> mode<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#using-fill-mode\"><i class=\"material-icons\">link</i></a></h3>\n<p>In cases where you want to have an image fill a containing element, you can use the <code>fill</code> attribute. This is often useful when you want to achieve a \"background image\" behavior. It can also be helpful when you don't know the exact width and height of your image, but you do have a parent container with a known size that you'd like to fit your image into (see \"object-fit\" below).</p>\n<p>When you add the <code>fill</code> attribute to your image, you do not need and should not include a <code>width</code> and <code>height</code>, as in this example:</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" fill>\n\n</code-example>\n<p>You can use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\">object-fit</a> CSS property to change how the image will fill its container. If you style your image with <code>object-fit: \"contain\"</code>, the image will maintain its aspect ratio and be \"letterboxed\" to fit the element. If you set <code>object-fit: \"cover\"</code>, the element will retain its aspect ratio, fully fill the element, and some content may be \"cropped\" off.</p>\n<p>See visual examples of the above at the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\">MDN object-fit documentation.</a></p>\n<p>You can also style your image with the <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/object-position\">object-position property</a> to adjust its position within its containing element.</p>\n<p><strong>Important note:</strong> For the \"fill\" image to render properly, its parent element <strong>must</strong> be styled with <code>position: \"relative\"</code>, <code>position: \"fixed\"</code>, or <code>position: \"absolute\"</code>.</p>\n<h2 id=\"using-placeholders\">Using placeholders<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#using-placeholders\"><i class=\"material-icons\">link</i></a></h2>\n<h3 id=\"automatic-placeholders\">Automatic placeholders<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#automatic-placeholders\"><i class=\"material-icons\">link</i></a></h3>\n<p>NgOptimizedImage can provide an automatic low-resolution placeholder for your image, as long as you're using a CDN or image host which provides automatic image resizing. To take advantage of this feature, just add the <code>placeholder</code> attribute to your image, as so:</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" placeholder>\n\n</code-example>\n<p>Adding this attribute will automatically request a second, smaller version of the image, using your specified image loader. This small image will be applied as a <code>background-image</code> style with a CSS blur while your image loads. If no image loader is provided, no placeholder image can be generated and an error will be thrown.</p>\n<p>The default size for generated placeholders is 30px wide, but you can make it larger or smaller by specifying a value in the <code><a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a></code> provider, as seen below:</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  {\n    provide: <a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a>,\n    useValue: {\n      placeholderResolution: 40\n    }\n  },\n],\n</code-example>\n<p>If you want sharp edges around your blurred placeholder, you can wrap your image in a containing <code>&#x3C;div></code> with the <code>overflow: hidden</code> style. As long as the <code>&#x3C;div></code> is the same size as the image (such as by using the <code>width: fit-content</code> style), the \"fuzzy edges\" of the placeholder will be hidden.</p>\n<h3 id=\"data-url-placeholders\">Data URL placeholders<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#data-url-placeholders\"><i class=\"material-icons\">link</i></a></h3>\n<p>You can also specify a placeholder using a base64 <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs\">data URL</a> without an image loader. The data url format is <code>data:image/[imagetype];[data]</code>, where <code>[imagetype]</code> is the image format, just as <code>png</code>, and <code>[data]</code> is a base64 encoding of the image. That encoding can be done using the command line or in JavaScript. For specific commands, see <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs#encoding_data_into_base64_format\">the MDN documentation</a>. An example of a data URL placeholder with truncated data is shown below:</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" placeholder=\"data:image/png;base64,iVBORw0K...\">\n\n</code-example>\n<p>However, large data URLs  increase the size of your Angular bundles and slow down page load. If you cannot use an image loader, the Angular team recommends keeping base64 placeholder images smaller than 4KB and using them exclusively on critical images. In addition to decreasing placeholder dimensions, consider changing image formats or parameters used when saving images. At very low resolutions, these parameters can have a large effect on file size.</p>\n<h3 id=\"non-blurred-placeholders\">Non-blurred placeholders<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#non-blurred-placeholders\"><i class=\"material-icons\">link</i></a></h3>\n<p>By default, NgOptimizedImage applies a CSS blur effect to image placeholders. To render a placeholder without blur, provide a <code>placeholderConfig</code> argument with an object that includes the <code>blur</code> property, set to false. For example:</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" placeholder [placeholderConfig]=\"{blur: false}\">\n\n</code-example>\n<h2 id=\"adjusting-image-styling\">Adjusting image styling<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#adjusting-image-styling\"><i class=\"material-icons\">link</i></a></h2>\n<p>Depending on the image's styling, adding <code>width</code> and <code>height</code> attributes may cause the image to render differently. <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> warns you if your image styling renders the image at a distorted aspect ratio.</p>\n<p>You can typically fix this by adding <code>height: auto</code> or <code>width: auto</code> to your image styles. For more information, see the <a href=\"https://web.dev/patterns/web-vitals-patterns/images/img-tag\">web.dev article on the <code>&#x3C;img></code> tag</a>.</p>\n<p>If the <code>height</code> and <code>width</code> attribute on the image are preventing you from sizing the image the way you want with CSS, consider using \"fill\" mode instead, and styling the image's parent element.</p>\n<h2 id=\"performance-features\">Performance Features<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#performance-features\"><i class=\"material-icons\">link</i></a></h2>\n<p>NgOptimizedImage includes a number of features designed to improve loading performance in your app. These features are described in this section.</p>\n<h3 id=\"resource-hints\">Resource hints<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#resource-hints\"><i class=\"material-icons\">link</i></a></h3>\n<p>A <a href=\"https://web.dev/preconnect-and-dns-prefetch\"><code>preconnect</code> resource hint</a> for your image origin ensures that the LCP image loads as quickly as possible.</p>\n<p>Preconnect links are automatically generated for domains provided as an argument to a <a href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\">loader</a>. If an image origin cannot be automatically identified, and no preconnect link is detected for the LCP image, <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> will warn during development. In that case, you should manually add a resource hint to <code>index.html</code>. Within the <code>&#x3C;head></code> of the document, add a <code>link</code> tag with <code>rel=\"preload\"</code>, as shown below:</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;link rel=\"preconnect\" href=\"https://my.cdn.origin\" />\n\n</code-example>\n<p>To disable preconnect warnings, inject the <code><a href=\"api/common/PRECONNECT_CHECK_BLOCKLIST\" class=\"code-anchor\">PRECONNECT_CHECK_BLOCKLIST</a></code> token:</p>\n<code-example format=\"typescript\" language=\"typescript\">\n\nproviders: [\n  {provide: <a href=\"api/common/PRECONNECT_CHECK_BLOCKLIST\" class=\"code-anchor\">PRECONNECT_CHECK_BLOCKLIST</a>, useValue: 'https://your-domain.com'}\n],\n\nSee more information on automatic preconnect generation [here](#why-is-a-preconnect-element-not-being-generated-for-my-image-domain).\n\n</code-example>\n<h3 id=\"request-images-at-the-correct-size-with-automatic-srcset\">Request images at the correct size with automatic <code>srcset</code><a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#request-images-at-the-correct-size-with-automatic-srcset\"><i class=\"material-icons\">link</i></a></h3>\n<p>Defining a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/srcset\"><code>srcset</code> attribute</a> ensures that the browser requests an image at the right size for your user's viewport, so it doesn't waste time downloading an image that's too large. <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> generates an appropriate <code>srcset</code> for the image, based on the presence and value of the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\"><code>sizes</code> attribute</a> on the image tag.</p>\n<h4 id=\"fixed-size-images\">Fixed-size images<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#fixed-size-images\"><i class=\"material-icons\">link</i></a></h4>\n<p>If your image should be \"fixed\" in size  (i.e. the same size across devices, except for <a href=\"https://web.dev/codelab-density-descriptors/\">pixel density</a>), there is no need to set a <code>sizes</code> attribute. A <code>srcset</code> can be generated automatically from the image's width and height attributes with no further input required.</p>\n<p>Example srcset generated: <code>&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> ... srcset=\"image-400w.jpg 1x, image-800w.jpg 2x\"></code></p>\n<h4 id=\"responsive-images\">Responsive images<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#responsive-images\"><i class=\"material-icons\">link</i></a></h4>\n<p>If your image should be responsive (i.e. grow and shrink according to viewport size), then you will need to define a <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\"><code>sizes</code> attribute</a> to generate the <code>srcset</code>.</p>\n<p>If you haven't used <code>sizes</code> before, a good place to start is to set it based on viewport width. For example, if your CSS causes the image to fill 100% of viewport width, set <code>sizes</code> to <code>100vw</code> and the browser will select the image in the <code>srcset</code> that is closest to the viewport width (after accounting for pixel density). If your image is only likely to take up half the screen (ex: in a sidebar), set <code>sizes</code> to <code>50vw</code> to ensure the browser selects a smaller image. And so on.</p>\n<p>If you find that the above does not cover your desired image behavior, see the documentation on <a href=\"guide/image-directive#advanced-sizes-values\">advanced sizes values</a>.</p>\n<p>By default, the responsive breakpoints are:</p>\n<p><code>[16, 32, 48, 64, 96, 128, 256, 384, 640, 750, 828, 1080, 1200, 1920, 2048, 3840]</code></p>\n<p>If you would like to customize these breakpoints, you can do so using the <code><a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a></code> provider:</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  {\n    provide: <a href=\"api/common/IMAGE_CONFIG\" class=\"code-anchor\">IMAGE_CONFIG</a>,\n    useValue: {\n      breakpoints: [16, 48, 96, 128, 384, 640, 750, 828, 1080, 1200, 1920]\n    }\n  },\n],\n</code-example>\n<p>If you would like to manually define a <code>srcset</code> attribute, you can provide your own using the <code>ngSrcset</code> attribute:</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"hero.jpg\" ngSrcset=\"100w, 200w, 300w\">\n\n</code-example>\n<p>If the <code>ngSrcset</code> attribute is present, <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> generates and sets the <code>srcset</code> based on the sizes included. Do not include image file names in <code>ngSrcset</code> - the directive infers this information from <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code>. The directive supports both width descriptors (e.g. <code>100w</code>) and density descriptors (e.g. <code>1x</code>).</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"hero.jpg\" ngSrcset=\"100w, 200w, 300w\" sizes=\"50vw\">\n\n</code-example>\n<h3 id=\"disabling-automatic-srcset-generation\">Disabling automatic srcset generation<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#disabling-automatic-srcset-generation\"><i class=\"material-icons\">link</i></a></h3>\n<p>To disable srcset generation for a single image, you can add the <code>disableOptimizedSrcset</code> attribute on the image:</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"about.jpg\" disableOptimizedSrcset>\n\n</code-example>\n<h3 id=\"disabling-image-lazy-loading\">Disabling image lazy loading<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#disabling-image-lazy-loading\"><i class=\"material-icons\">link</i></a></h3>\n<p>By default, <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> sets <code>loading=lazy</code> for all images that are not marked <code>priority</code>. You can disable this behavior for non-priority images by setting the <code>loading</code> attribute. This attribute accepts values: <code>eager</code>, <code>auto</code>, and <code>lazy</code>. <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/loading#value\">See the documentation for the standard image <code>loading</code> attribute for details</a>.</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" loading=\"eager\">\n\n</code-example>\n<h3 id=\"advanced-sizes-values\">Advanced 'sizes' values<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#advanced-sizes-values\"><i class=\"material-icons\">link</i></a></h3>\n<p>You may want to have images displayed at varying widths on differently-sized screens. A common example of this pattern is a grid- or column-based layout that renders a single column on mobile devices, and two columns on larger devices. You can capture this behavior in the <code>sizes</code> attribute, using a \"media query\" syntax, such as the following:</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"cat.jpg\" width=\"400\" height=\"200\" sizes=\"(max-width: 768px) 100vw, 50vw\">\n\n</code-example>\n<p>The <code>sizes</code> attribute in the above example says \"I expect this image to be 100 percent of the screen width on devices under 768px wide. Otherwise, I expect it to be 50 percent of the screen width.</p>\n<p>For additional information about the <code>sizes</code> attribute, see <a href=\"https://web.dev/learn/design/responsive-images/#sizes\">web.dev</a> or <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\">MDN</a>.</p>\n<h2 id=\"configuring-an-image-loader-for-ngoptimizedimage\">Configuring an image loader for <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code><a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h2>\n<p>A \"loader\" is a function that generates an <a href=\"https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options\">image transformation URL</a> for a given image file. When appropriate, <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> sets the size, format, and image quality transformations for an image.</p>\n<p><code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> provides both a generic loader that applies no transformations, as well as loaders for various third-party image services. It also supports writing your own custom loader.</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Loader type</th>\n<th align=\"left\">Behavior</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">Generic loader</td>\n<td align=\"left\">The URL returned by the generic loader will always match the value of <code>src</code>. In other words, this loader applies no transformations. Sites that use Angular to serve images are the primary intended use case for this loader.</td>\n</tr>\n<tr>\n<td align=\"left\">Loaders for third-party image services</td>\n<td align=\"left\">The URL returned by the loaders for third-party image services will follow API conventions used by that particular image service.</td>\n</tr>\n<tr>\n<td align=\"left\">Custom loaders</td>\n<td align=\"left\">A custom loader's behavior is defined by its developer. You should use a custom loader if your image service isn't supported by the loaders that come preconfigured with <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>.</td>\n</tr>\n</tbody>\n</table>\n<p>Based on the image services commonly used with Angular applications, <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> provides loaders preconfigured to work with the following image services:</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Image Service</th>\n<th align=\"left\">Angular API</th>\n<th align=\"left\">Documentation</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">Cloudflare Image Resizing</td>\n<td align=\"left\"><code><a href=\"api/common/provideCloudflareLoader\" class=\"code-anchor\">provideCloudflareLoader</a></code></td>\n<td align=\"left\"><a href=\"https://developers.cloudflare.com/images/image-resizing/\">Documentation</a></td>\n</tr>\n<tr>\n<td align=\"left\">Cloudinary</td>\n<td align=\"left\"><code><a href=\"api/common/provideCloudinaryLoader\" class=\"code-anchor\">provideCloudinaryLoader</a></code></td>\n<td align=\"left\"><a href=\"https://cloudinary.com/documentation/resizing_and_cropping\">Documentation</a></td>\n</tr>\n<tr>\n<td align=\"left\">ImageKit</td>\n<td align=\"left\"><code><a href=\"api/common/provideImageKitLoader\" class=\"code-anchor\">provideImageKitLoader</a></code></td>\n<td align=\"left\"><a href=\"https://docs.imagekit.io/\">Documentation</a></td>\n</tr>\n<tr>\n<td align=\"left\">Imgix</td>\n<td align=\"left\"><code><a href=\"api/common/provideImgixLoader\" class=\"code-anchor\">provideImgixLoader</a></code></td>\n<td align=\"left\"><a href=\"https://docs.imgix.com/\">Documentation</a></td>\n</tr>\n<tr>\n<td align=\"left\">Netlify</td>\n<td align=\"left\"><code><a href=\"api/common/provideNetlifyLoader\" class=\"code-anchor\">provideNetlifyLoader</a></code></td>\n<td align=\"left\"><a href=\"https://docs.netlify.com/image-cdn/overview/\">Documentation</a></td>\n</tr>\n</tbody>\n</table>\n<p>To use the <strong>generic loader</strong> no additional code changes are necessary. This is the default behavior.</p>\n<h3 id=\"built-in-loaders\">Built-in Loaders<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#built-in-loaders\"><i class=\"material-icons\">link</i></a></h3>\n<p>To use an existing loader for a <strong>third-party image service</strong>, add the provider factory for your chosen service to the <code>providers</code> array. In the example below, the Imgix loader is used:</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  <a href=\"api/common/provideImgixLoader\" class=\"code-anchor\">provideImgixLoader</a>('https://my.base.url/'),\n],\n</code-example>\n<p>The base URL for your image assets should be passed to the provider factory as an argument. For most sites, this base URL should match one of the following patterns:</p>\n<ul>\n<li><a href=\"https://yoursite.yourcdn.com\">https://yoursite.yourcdn.com</a></li>\n<li><a href=\"https://subdomain.yoursite.com\">https://subdomain.yoursite.com</a></li>\n<li><a href=\"https://subdomain.yourcdn.com/yoursite\">https://subdomain.yourcdn.com/yoursite</a></li>\n</ul>\n<p>You can learn more about the base URL structure in the docs of a corresponding CDN provider.</p>\n<h3 id=\"custom-loaders\">Custom Loaders<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#custom-loaders\"><i class=\"material-icons\">link</i></a></h3>\n<p>To use a <strong>custom loader</strong>, provide your loader function as a value for the <code><a href=\"api/common/IMAGE_LOADER\" class=\"code-anchor\">IMAGE_LOADER</a></code> DI token. In the example below, the custom loader function returns a URL starting with <code>https://example.com</code> that includes <code>src</code> and <code>width</code> as URL parameters.</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  {\n    provide: <a href=\"api/common/IMAGE_LOADER\" class=\"code-anchor\">IMAGE_LOADER</a>,\n    useValue: (config: <a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a>) => {\n      return `https://example.com/images?src=${config.src}&#x26;width=${config.width}`;\n    },\n  },\n],\n</code-example>\n<p>A loader function for the <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> directive takes an object with the <code><a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a></code> type (from <code>@angular/common</code>) as its argument and returns the absolute URL of the image asset. The <code><a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a></code> object contains the <code>src</code> property, and optional <code>width</code> and <code>loaderParams</code> properties.</p>\n<p>Note: even though the <code>width</code> property may not always be present, a custom loader must use it to support requesting images at various widths in order for <code>ngSrcset</code> to work properly.</p>\n<h3 id=\"the-loaderparams-property\">The <code>loaderParams</code> Property<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#the-loaderparams-property\"><i class=\"material-icons\">link</i></a></h3>\n<p>There is an additional attribute supported by the <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> directive, called <code>loaderParams</code>, which is specifically designed to support the use of custom loaders. The <code>loaderParams</code> attribute takes an object with any properties as a value, and does not do anything on its own. The data in <code>loaderParams</code> is added to the <code><a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a></code> object passed to your custom loader, and can be used to control the behavior of the loader.</p>\n<p>A common use for <code>loaderParams</code> is controlling advanced image CDN features.</p>\n<h3 id=\"example-custom-loader\">Example custom loader<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#example-custom-loader\"><i class=\"material-icons\">link</i></a></h3>\n<p>The following shows an example of a custom loader function. This example function concatenates <code>src</code> and <code>width</code>, and uses <code>loaderParams</code> to control a custom CDN feature for rounded corners:</p>\n<code-example format=\"typescript\" language=\"typescript\">\nconst myCustomLoader = (config: <a href=\"api/common/ImageLoaderConfig\" class=\"code-anchor\">ImageLoaderConfig</a>) => {\n  let url = `https://example.com/images/${config.src}?`;\n  let queryParams = [];\n  if (config.width) {\n    queryParams.push(`w=${config.width}`);\n  }\n  if (config.loaderParams?.roundedCorners) {\n    queryParams.push('mask=corners&#x26;corner-radius=5');\n  }\n  return url + queryParams.join('&#x26;');\n};\n</code-example>\n<p>Note that in the above example, we've invented the 'roundedCorners' property name to control a feature of our custom loader. We could then use this feature when creating an image, as follows:</p>\n<code-example format=\"html\" language=\"html\">\n\n&#x3C;<a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">img</a> <a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a>=\"profile.jpg\" width=\"300\" height=\"300\" [loaderParams]=\"{roundedCorners: true}\">\n\n</code-example>\n<h2 id=\"frequently-asked-questions\">Frequently Asked Questions<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#frequently-asked-questions\"><i class=\"material-icons\">link</i></a></h2>\n<h3 id=\"does-ngoptimizedimage-support-the-background-image-css-property\">Does NgOptimizedImage support the <code>background-image</code> css property?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#does-ngoptimizedimage-support-the-background-image-css-property\"><i class=\"material-icons\">link</i></a></h3>\n<p>The NgOptimizedImage does not directly support the <code>background-image</code> css property, but it is designed to easily accommodate the use case of having an image as the background of another element.</p>\n<p>Here's a simple step-by-step process for migrating from <code>background-image</code> to <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>. For these steps, we'll refer to the element that has an image background as the \"containing element\":</p>\n<p>1) Remove the <code>background-image</code> style from the containing element.\n2) Ensure that the containing element has <code>position: \"relative\"</code>,Â <code>position: \"fixed\"</code>, orÂ <code>position: \"absolute\"</code>.\n3) Create a new image element as a child of the containing element, using <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code> to enable the <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code> directive.\n4) Give that element the <code>fill</code> attribute. Do not include a <code>height</code> and <code>width</code>.\n5) If you believe this image might be your <a href=\"https://web.dev/lcp/\">LCP element</a>, add the <code>priority</code> attribute to the image element.</p>\n<p>You can adjust how the background image fills the container as described in the <a href=\"guide/image-directive#using-fill-mode\">Using fill mode</a> section.</p>\n<h3 id=\"why-cant-i-use-src-with-ngoptimizedimage\">Why can't I use <code>src</code> with <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">NgOptimizedImage</a></code>?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#why-cant-i-use-src-with-ngoptimizedimage\"><i class=\"material-icons\">link</i></a></h3>\n<p>The <code><a href=\"api/common/NgOptimizedImage\" class=\"code-anchor\">ngSrc</a></code> attribute was chosen as the trigger for NgOptimizedImage due to technical considerations around how images are loaded by the browser. NgOptimizedImage makes programmatic changes to the <code>loading</code> attribute--if the browser sees the <code>src</code> attribute before those changes are made, it will begin eagerly downloading the image file, and the loading changes will be ignored.</p>\n<h3 id=\"can-i-use-two-different-image-domains-in-the-same-page\">Can I use two different image domains in the same page?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#can-i-use-two-different-image-domains-in-the-same-page\"><i class=\"material-icons\">link</i></a></h3>\n<p>The <a href=\"guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\">image loaders</a> provider pattern is designed to be as simple as possible for the common use case of having only a single image CDN used within a component. However, it's still very possible to manage multiple image CDNs using a single provider.</p>\n<p>To do this, we recommend writing a <a href=\"guide/image-directive#custom-loaders\">custom image loader</a> which uses the <a href=\"guide/image-directive#the-loaderparams-property\"><code>loaderParams</code> property</a> to pass a flag that specifies which image CDN should be used, and then invokes the appropriate loader based on that flag.</p>\n<h3 id=\"why-is-a-preconnect-element-not-being-generated-for-my-image-domain\">Why is a preconnect element not being generated for my image domain?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#why-is-a-preconnect-element-not-being-generated-for-my-image-domain\"><i class=\"material-icons\">link</i></a></h3>\n<p>Preconnect generation is performed based on static analysis of your application. That means that the image domain must be directly included in the loader parameter, as in the following example:</p>\n<code-example format=\"typescript\" language=\"typescript\">\nproviders: [\n  <a href=\"api/common/provideImgixLoader\" class=\"code-anchor\">provideImgixLoader</a>('https://my.base.url/'),\n],\n</code-example>\n<p>If you use a variable to pass the domain string to the loader, or you're not using a loader, the static analysis will not be able to identify the domain, and no preconnect link will be generated. In this case you should manually add a preconnect link to the document head, as <a href=\"guide/image-directive#resource-hints\">described above.</a>.</p>\n<h3 id=\"can-you-add-a-new-built-in-loader-for-my-preferred-cdn\">Can you add a new built-in loader for my preferred CDN?<a title=\"Link to this heading\" class=\"header-link\" aria-hidden=\"true\" href=\"guide/image-directive#can-you-add-a-new-built-in-loader-for-my-preferred-cdn\"><i class=\"material-icons\">link</i></a></h3>\n<p>For maintenance reasons, we don't currently plan to support additional built-in loaders in the Angular repository. Instead, we encourage developers to publish any additional image loaders as third-party packages.</p>\n<!-- links -->\n<!-- external links -->\n<!--end links -->\n\n  <div class=\"reviewed\">Last reviewed on Tue Jul 18 2023</div>\n</div>\n\n<!-- links to this doc:\n - api/common\n - api/common/ImageConfig\n - guide/update-to-version-15\n-->\n<!-- links from this doc:\n - /guide/ssr\n - /guide/standalone-components\n - api/common/IMAGE_CONFIG\n - api/common/IMAGE_LOADER\n - api/common/ImageLoaderConfig\n - api/common/NgOptimizedImage\n - api/common/PRECONNECT_CHECK_BLOCKLIST\n - api/common/provideCloudflareLoader\n - api/common/provideCloudinaryLoader\n - api/common/provideImageKitLoader\n - api/common/provideImgixLoader\n - api/common/provideNetlifyLoader\n - guide/image-directive#adjusting-image-styling\n - guide/image-directive#advanced-sizes-values\n - guide/image-directive#automatic-placeholders\n - guide/image-directive#built-in-loaders\n - guide/image-directive#can-i-use-two-different-image-domains-in-the-same-page\n - guide/image-directive#can-you-add-a-new-built-in-loader-for-my-preferred-cdn\n - guide/image-directive#configuring-an-image-loader-for-ngoptimizedimage\n - guide/image-directive#custom-loaders\n - guide/image-directive#data-url-placeholders\n - guide/image-directive#disabling-automatic-srcset-generation\n - guide/image-directive#disabling-image-lazy-loading\n - guide/image-directive#does-ngoptimizedimage-support-the-background-image-css-property\n - guide/image-directive#example-custom-loader\n - guide/image-directive#fixed-size-images\n - guide/image-directive#frequently-asked-questions\n - guide/image-directive#getting-started\n - guide/image-directive#getting-started-with-ngoptimizedimage\n - guide/image-directive#non-blurred-placeholders\n - guide/image-directive#performance-features\n - guide/image-directive#request-images-at-the-correct-size-with-automatic-srcset\n - guide/image-directive#resource-hints\n - guide/image-directive#responsive-images\n - guide/image-directive#step-1-import-ngoptimizedimage\n - guide/image-directive#step-2-optional-set-up-a-loader\n - guide/image-directive#step-3-enable-the-directive\n - guide/image-directive#step-4-mark-images-as-priority\n - guide/image-directive#step-5-include-height-and-width\n - guide/image-directive#the-loaderparams-property\n - guide/image-directive#using-fill-mode\n - guide/image-directive#using-placeholders\n - guide/image-directive#why-cant-i-use-src-with-ngoptimizedimage\n - guide/image-directive#why-is-a-preconnect-element-not-being-generated-for-my-image-domain\n - http://web.dev/lcp\n - https://cloudinary.com/documentation/resizing_and_cropping\n - https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/loading#value\n - https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes\n - https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/srcset\n - https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit\n - https://developer.mozilla.org/en-US/docs/Web/CSS/object-position\n - https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload\n - https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs\n - https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs#encoding_data_into_base64_format\n - https://developers.cloudflare.com/images/image-resizing/\n - https://docs.imagekit.io/\n - https://docs.imgix.com/\n - https://docs.netlify.com/image-cdn/overview/\n - https://subdomain.yourcdn.com/yoursite\n - https://subdomain.yoursite.com\n - https://web.dev/browser-level-image-lazy-loading\n - https://web.dev/codelab-density-descriptors/\n - https://web.dev/css-web-vitals/#images-and-largest-contentful-paint-lcp\n - https://web.dev/css-web-vitals/#images-and-layout-shifts\n - https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options\n - https://web.dev/lcp/\n - https://web.dev/lcp/#what-elements-are-considered\n - https://web.dev/learn/design/responsive-images/#sizes\n - https://web.dev/patterns/web-vitals-patterns/images/img-tag\n - https://web.dev/preconnect-and-dns-prefetch\n - https://web.dev/priority-hints\n - https://yoursite.yourcdn.com\n-->"
}